<html lang="ko">
<head>
	<meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Widevantage 데이터 관리 페이지</title>
	<link rel='stylesheet' href='css/bootstrap.min.css'>
	<link rel='stylesheet' href='css/main.css'>
</head>
<body>	
	
	<div class="container-fluid">
		<div class="row content">
			<div class="col-sm-2 sidenav hidden-xs">
				<h2 class="myside-title">WideMin</h2>
				<ul class="nav nav-pills nav-stacked">
						<li class="myside-menu">MotionIDs</li>
						<li class="myside-content active"><a class="myside-content-text" href="motionid.html">&gt; 모션아이디 리스트</a></li>
						<li class="myside-content"><a class="myside-content-text" href="category.html">&gt; 모션아이디 카테고리 설정</a></li>
						<li class="myside-menu">Device Models</li>
						<li class="myside-content"><a class="myside-content-text" href="../models/modelList.html">&gt; 모델 측정 리스트</a></li>
						<li class="myside-content"><a class="myside-content-text" href="../models/modelGroup.html">&gt; 모델 카테고리 설정</a></li>
						<li class="myside-menu">Logs</li>
						<li class="myside-content"><a class="myside-content-text" href="../models/logList.html">&gt; 로그 관리</a></li>
				</ul><br>
			</div>
			
  		<div class="col-sm-10"> 
				<div class="myHeader">
					<h2 class="myHeader-title">모션 아이디 리스트</h2>
					<p class="myHeader-content">
							아래 테이블은 각 모션아이디에 대한 데이터를 보여줍니다.
					</p>
				</div>
				<div class="row">
					<div class="dropdown">
							<button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
								카테고리 선택
								<span class="caret"></span>
							</button>
							<ul id="dropdownMenuResult" class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
							</ul>
						</div>
						<input class="btn btn-default" type="button" data-toggle="modal" data-target="#AddModal" value="모션아이디 생성">
					</div>
					<div class="row">
						<table class="table table-bordered myTable" style="font-size:smaller">
							<thead>
								<tr>
									<th><input type="checkbox" name="_selected_all_"></th>
									<th>카테고리</th>
									<th>모션아이디</th>
									<th>이메일</th>
									<th>사용자1</th>
									<th>디바이스1</th>
									<th>업데이트 날짜1</th>
									<th>사용자2</th>
									<th>디바이스2</th>
									<th>업데이트 날짜2</th>
									<th>사용자3</th>
									<th>디바이스3</th>
									<th>업데이트 날짜3</th>
								</tr>
							</thead>
							<tbody>
							</tbody>
						</table>
					</div>
					<div class="row" style="margin-top:0px">
						<p id="count">총 결과 개수 :</p>
						<input class="btn btn-default" type="button" id="delete_btn" value="삭제">
						<input class="btn btn-default" type="button" id="modify_btn" data-toggle="modal" data-target="#ModifyModal" value="수정">
					</div>
					<div class="text-center">
						<ul class="pagination">
							<li id="prev">
								<a href="#" aria-label="Previous">
									<span aria-hidden="true">&laquo;</span>
								</a>
							</li>
							<li id="first_page" class="active"><a href="#" class="page">1</a></li>
							<li id="after">
								<a href="#" aria-label="Next">
									<span aria-hidden="true">&raquo;</span>
								</a>
							</li>
						</ul>
					</div>
			</div>
			
		</div>
	</div>
	
	<!--수정 모달 창-->
	<div class="modal fade" id="ModifyModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"></button>
					<h4 class="modal-title">수정하기</h4>
				</div>
				<div id="myCarousel" class="modal-body carousel slide" data-ride="carousel">
					<div class="carousel-inner" role="listbox">
						<div class="item active">
							<p id="modify_type0">카테고리 : </p>
							<p id="modify_id0">모션아이디 : </p>
						</div>
					</div>
					<a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
						<span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
						<span class="sr-only">Previous</span>
					</a>
					<a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
						<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
						<span class="sr-only">Next</span>
					</a>
				</div>
				<div class="modal-footer">
					<input type="submit" class="btn btn-primary" id="modify_btn_Modal" value="수정">
					<button type="button" onclick=" return resetSearch2()" class="btn btn-default" data-dismiss="modal">취소</button>
				</div>
			</div><!-- /.modal-content -->
		</div><!-- /.modal-dialog -->
	</div><!-- /.modal -->
		
	<!--랜덤생성 모달 창-->
	<div class="modal fade" id="AddModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-backdrop="static" data-keyboard="false">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"></button>
					<h4 class="modal-title">생성하기</h4>
				</div>
				<div class="modal-body">
					<h5>1개 / 여러 개 중 하나를 반드시 선택 후, 생성버튼을 누르시기 바랍니다.</h5>
					<h5>1개 생성 시 아래 화면에 나오는 결과를 DB에 저장하고싶을 경우, 아래 DB에 저장 버튼을 누르시기 바랍니다.</h5>
					<h5>여러 개 생성 시 다운로드된 파일을 확인하고 아래 DB에 저장 버튼을 누르시기 바랍니다.</h5>
					<div class="row modal-row">
						<label class="radio-inline">
							<input type="radio" name="count" id="add_one">1개 생성
						</label>
						<label class="radio-inline">
							<input type="radio" name="count" id="add_several">여러 개 생성
						</label>
						<div class="dropdown">
							<button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu2" data-toggle="dropdown" aria-expanded="true">
								카테고리 선택
								<span class="caret"></span>
							</button>
							<ul id="dropdownMenuResult2" class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu2">
							</ul>
						</div>
						<input class="form-control" id="add_count" placeholder="개수 입력 (반드시 숫자)" >
						<input type="submit" class="search" id="generate_id" value="생성">
					</div>
					<h5>생성 결과</h5>
					<p id="genresult_type" style="display:none">카테고리 : </p>
					<p id="genresult_id" style="display:none">모션아이디 : </p>
					<a id="genresult_download" style="display:none">다운로드</a>
					<p id="genresult_several" style="display:none">다운로드된 파일을 확인하시고, DB저장을 원할 경우 DB에 저장 버튼을 누르시기 바랍니다.</p>
				</div>
				<div class="modal-footer">
					<input type="submit" class="btn btn-primary" id="save_btn" value="DB에 저장">
					<button type="button" onclick=" return resetSearch3()" class="btn btn-default" data-dismiss="modal">취소</button>
				</div>
			</div><!-- /.modal-content -->
		</div><!-- /.modal-dialog -->
	</div><!-- /.modal -->
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
  <script src="js/bootstrap.js"></script>
	<script>
		var page_criteria = 10;
		var result = null;
		var i;
		var current_cate = null;
		var add_current_cate = null;
		var gen_type_one = null;
		var gen_id_one = null;
		var gen_type_several = [];
		var gen_id_several = [];
		var tempString = null;
		var check_save_several = 0;
		var total_page = 1;
		var page_arr = [];
		var current_first_page_num = 1;
		var check_firstLoad = "all_load"
		var head_arr = [];
		
		$(".carousel").carousel({ interval:false });
		
		window.onload = function(){
				$.ajax({
				url: "php/load_paramlist.php",
				async:false,
				data: {"table": "tb_motionid"},
				success: function(data){
					result = JSON.parse(data); 
					head_arr = result;
				},
				error: function(data){
					alert("error by load_paramlist.php");
				}
			});	
			
			firstPageLoading(0);
			loadByCate(1);
			pageClicked();
		};
		
		// 수정 모달 창 리셋
		function resetSearch2(){
			$(".item").remove();	
			
			$(".carousel-inner").append('<div class="item active"><p id="modify_type0">카테고리 : </p><p id="modify_id0">모션아이디 : </p></div>');
			
			$("#ModifyModal").modal('hide');
		}
		
		// 랜덤생성 모달 창 리셋
		function resetSearch3(){
			add_current_cate = null;
			document.getElementById("dropdownMenu2").innerHTML = '카테고리 선택<span class="caret"></span>';
			$("#add_count").val(null);
			
			var radiobox = document.getElementsByName("count");
			radiobox[0].checked = false;
			radiobox[1].checked = false; 
			
			$("#genresult_several").css('display', 'none');
			$("#genresult_id").css('display', 'none');
			$("#genresult_type").css('display', 'none');
			$("#genresult_download").css('display', 'none');
			$("#genresult_type").text('카테고리 : ');
			$("#genresult_id").text('모션아이디 : ');
			
			$("#AddModal").modal('hide');
		}
				
		
		// 체크박스 all 관리
		$('input[name=_selected_all_]').on('change', function(){
			$('input[name=_selected_]').prop('checked', this.checked);
		});
		
		$(".myTable tbody").on('click', 'tr' , function(){
			var index = $(this)[0].childNodes[0].childNodes[0].value;
			
			if($('input[name=_selected_][value=' + index + ']').is(":checked"))
				$('input[name=_selected_][value=' + index + ']').prop('checked', false);
			else
				$('input[name=_selected_][value=' + index + ']').prop('checked', true);
		});
				
		function leadingZeros(n, digits) {
			var zero = '';
			n = n.toString();

			if (n.length < digits) {
				for (var i = 0; i < digits - n.length; i++)
					zero += '0';
			}
			return zero + n;
		}
		
		// 모션아이디 랜덤 생성
		function generateId(gentype){
			var ID = null;
			var check = 1;
			
			// 시리얼 넘버 받아오기
			$.ajax({
				url: "php/load_serial.php",
				type: "GET",
				async:false,
				data: {"cate_name": gentype},
				success: function(data){
					result = JSON.parse(data);
					
					ID = result[0];
				},
				error: function(data){
					alert("error by load_serial.php");
				}
			});
			
			// 기존에 있는 것인지 체크
			while(check){
				var temp = leadingZeros((Math.floor(Math.random() * 1000000) + 1), 6);
				$.ajax({
					url: "php/check_motionid.php",
					type: "GET",
					async:false,
					data: {	"motion_id": ID + temp,
									"motion_type": gentype},
					success: function(data){
						result = JSON.parse(data)

						if(result == null){
								ID += temp;
								check = 0;
						}
					},
					error: function(data){
						alert("error by check_motionid.php");
					}
				});
			}
			
			return ID;
		}
		
		function loadByCate(page_num){
			
			$.ajax({
				url: "php/load_by_cate.php",
				type: "GET",
				async:false,
				data: {	"motion_type": current_cate,
								"check": check_firstLoad,
								"page": page_num},
				success: function(data){
					//테이블 리셋
					$('tbody').children().remove();
				
					if(data != "0"){
						result = JSON.parse(data);
						
						//결과 출력
						if(result != null){
							for(i=0; i<result.length; i++){
								//업데이트 날짜 시간부분 삭제
								if(result[i][6] != null) result[i][6] = result[i][6].substring(0,10);
								if(result[i][9] != null) result[i][9] = result[i][9].substring(0,10);
								if(result[i][12] != null) result[i][12] = result[i][12].substring(0,10);
								
								var str = '<tr id="tr_' + (i+1) + '"><td><input type="checkbox" name="_selected_" value="' + result[i][0] +'"></td><td class="cate_data" data-container="body" data-toggle="popover" data-placement="top">'+ result[i][1] +'</td><td>'+ result[i][2] +'</td><td>'+ result[i][3] +'</td><td>'+ result[i][4] +'</td><td>'+ result[i][5] +'</td><td>'+ result[i][6] +'</td><td>'+ result[i][7] +'</td><td>'+ result[i][8] +'</td><td>'+ result[i][9] +'</td><td>'+ result[i][10] +'</td><td>'+ result[i][11] +'</td><td>'+ result[i][12] +'</td></tr>';

								$('tbody:last').append(str);
							}
							
							//카테고리 호버 시
							$(".cate_data").mouseover(function(){
								var content = "";
								$.ajax({
									url: "php/load_params_value.php",
									type: "GET",
									async:false,
									data: {	"category": $(this).text()},
									success: function(data){
										if(data != "0"){
											content = data;
										}
									},
									error: function(data){
										alert("error by load_params_value.php");
									}
								});

								$(this).attr("data-content", content);
								$(this).popover({
									html: true
								}).popover('show');

							});
							$(".cate_data").mouseout(function(){
								$(this).popover('hide');
							});
						
						}
					}
				},
				error: function(data){
					alert("error by load_by_cate.php");
				}
			});	
		}
		
		//페이지 버튼 누르면		
		function pageClicked(){
			$(".page").on('click', function(){
				$(this).parent().siblings().removeClass("active");
				$(this).parent().addClass("active");

				loadByCate($(this).html());
			});
		}
		
		function firstPageLoading(category){
			total_page = 1;
			current_first_page_num = 1;
			page_arr = [];
			
			$('input[name=_selected_all_]').prop('checked', false);

			$(".page").parent().remove();
			$("#prev").after('<li id="first_page" class="active"><a href="#" class="page">1</a></li>');

			if(category != 0){
				current_cate = category.val();
				document.getElementById("dropdownMenu1").innerHTML = current_cate + '<span class="caret"></span>';
			}

			// 페이지 로딩
			$.ajax({
				url: "php/load_page.php",
				type: "GET",
				async:false,
				data: {	"motion_type": current_cate,
								"check":check_firstLoad},
				success: function(data){
					result = JSON.parse(data);

					//개수 출력
					if(result != null){
						$('#count').text("총 결과 개수 : " + result[0]);

						// 10개씩 paging
						if((result[0] % page_criteria) == 0) total_page = Math.floor(result[0] / page_criteria);
						else total_page = Math.floor(result[0] / page_criteria) + 1; 

						var j=0;
						for(i=1; i <= total_page; i++){
							if((j % page_criteria) == 0) page_arr[j++] = '<li id="first_page" class="active"><a href="#" class="page">' + i + '</a></li>';
							else page_arr[j++] = '<li><a href="#" class="page">' + i + '</a></li>';
						}

						if(total_page <= page_criteria){
							for(i=total_page-1; i >= current_first_page_num; i--){
								$("#first_page").after(page_arr[i]);
							}
						}
						else{
							for(i=page_criteria-1; i >= current_first_page_num; i--){
								$("#first_page").after(page_arr[i]);
							}
						}
					}
					else $('#count').text("총 결과 개수 : 0");
				},
				error: function(data){
					alert("error by load_page.php");
				}
			});
		}
		
		function cateClicked(category){
			check_firstLoad = 0;
			firstPageLoading(category);

			loadByCate(1);

			pageClicked();
		}
		
		// 조회 - 카테고리 드롭박스 클릭 시
		$("#dropdownMenu1").on('click', function(){
			$.ajax({
				url: "php/load_cate.php",
				type: "GET",
				async:false,
				success: function(data){
					result = JSON.parse(data);	
				
					$("#dropdownMenuResult").children().remove();
					
					if(result){
						for(i=0; i<result.length; i++){
							$('#dropdownMenuResult:last').append('<li role="presentation"><input class="cate" type="submit" value="' + result[i][0] +'"></li>');
						}
					}
						 
					$(".cate").on('click', function() {
						cateClicked($(this));
					});
				},
				error: function(data){
					alert("error by load_cate.php");
				}
			});
		});
		
		// 이전 버튼 클릭 시
		$("#prev").on('click', function(){
			if(current_first_page_num - page_criteria >= 1){

				current_first_page_num = current_first_page_num - 10;

				$(".page").parent().remove();

				$("#prev").after(page_arr[current_first_page_num-1]);
				for(i=(current_first_page_num-1 + page_criteria-1); i >= current_first_page_num; i--){
					$("#first_page").after(page_arr[i]);
				}

				loadByCate(current_first_page_num);

				pageClicked();
			}
		});

		// 다음 버튼 클릭 시
		$("#after").on('click', function(){
			if(current_first_page_num + page_criteria <= total_page){
				current_first_page_num = current_first_page_num + 10;

				$(".page").parent().remove();

				$("#prev").after(page_arr[current_first_page_num-1]);
				for(i=(current_first_page_num-1 + page_criteria-1); i >= current_first_page_num; i--){
					$("#first_page").after(page_arr[i]);
				}

				loadByCate(current_first_page_num);

				pageClicked();
			}
		});
		
		// 삭제 버튼 클릭 시
		$("#delete_btn").on('click', function(){
			if($('input[name=_selected_]:checked').length != 0){
				var check = 0;
				for(i=0; i< $('input[name=_selected_]:checked').length; i++){
					$.ajax({
							url: "php/delete_by_index.php",
							type: "GET",
							async:false,
							data: {	"seq": $('input[name=_selected_]:checked')[i].value,
											"table": "tb_motionid"},
							success: function(data){
								check += 1;
							},
							error: function(data){
								alert("error by delete_by_index.php");
							}
						});
				}
				if(check == $('input[name=_selected_]:checked').length){
					alert("삭제되었습니다.");
					if (current_cate == null) window.location.reload(true);
					else cateClicked($("input[value=" + current_cate + "]"));
				}
			}
			else alert("삭제할 데이터의 체크박스를 클릭해야 합니다.");
		});
		
		//메인 화면에서 수정 버튼 클릭 시 
		$("#modify_btn").on('click', function(event){
			if($('input[name=_selected_]:checked').length != 0){
				// 수정할 정보 로딩
				for(var index=0; index < $('input[name=_selected_]:checked').length ; index++){	
					if(index != 0){
						$(".carousel-inner").children().last().after('<div class="item"><p id="modify_type' + index
																												 + '">카테고리 : </p><p id="modify_id' + index
																												 +'">모션아이디 : </p></div>');
					}
					
					$.ajax({
						url: "php/load_by_index.php",
						type: "GET",
						async:false,
						data: {	"seq": $('input[name=_selected_]:checked')[index].value,
										"table": "tb_motionid"},
						success: function(data){
							result = JSON.parse(data);

							$('#modify_type' + index).text("카테고리 : " + result[1]);
							$('#modify_id' + index).text("모션아이디 : " + result[2]);
						
							var head_name = [];
							var a = 0;
							$('thead > tr > th').each(function(){
								head_name[a++] = $(this).text();
							})
 
							for(i=(result.length - 1); i>2; i--){
								var string = "";
								
								if((i%3 == 0) && (i != 3)) string = '<p id="' + head_arr[i][0] + '_' + index + '">' + head_name[i] + ' : ' +  + '</p>';
								else{
									string = '<div class="row modal-row modify_param"><p>' + head_name[i] + ' : </p><input class="form-control" id="'
														+ head_arr[i][0] +'_' + index + '"></div>';
								}
								
								$("#modify_id" + index).after(string);
							}

							for(i=3; i<result.length; i++)
								if((i%3 == 0) && (i != 3)) $('#' + head_arr[i][0] + '_' + index).text(head_name[i] + " : " + result[i]);
								else $('#' + head_arr[i][0] + '_' + index).val(result[i]);
 
						},
						error: function(data){
							alert("error by load_by_index.php");
						}
					});
				}
				
			}
			else{
				alert("수정할 데이터의 체크박스를 클릭해야 합니다.");
				event.stopImmediatePropagation();
				resetSearch2();
			}
		});
		
		// 수정 모달 창에서 수정 버튼 클릭 시
		$("#modify_btn_Modal").on('click', function(){
			var check = 0;
			var param_arr = "";
			for(i=3; i<13; i++){
				if((i%3 == 0) && (i != 3)) continue;
				else{
					if (i == 11) param_arr += head_arr[i][0];
					else param_arr += head_arr[i][0] + ",";
				}
			}
					
			for(var index = 0; index < $('input[name=_selected_]:checked').length; index++){
				var paramValue = "";
				for(i=3; i<13; i++){
					if((i%3 == 0) && (i != 3)) continue;
					else{
						paramValue += ($('#' + head_arr[i][0] + "_" + index).val() + ",,");
					}
				}
				
				$.ajax({
					url: "php/modify_by_index.php",
					type: "GET",
					async:false,
					data: {	"seq": $('input[name=_selected_]:checked')[index].value,
									"cate_params": param_arr, 
									"param_value": paramValue,
									"table": "tb_motionid"},
					success: function(data){
								check += 1; 
						},		
					error: function(data){
						alert("error by modify_by_index.php");
					}
				});
			}	
			
			if(check == $('input[name=_selected_]:checked').length)	{
				alert("수정되었습니다");
				resetSearch2();
				if (current_cate == null) window.location.reload(true);
				else cateClicked($("input[value=" + current_cate + "]"));
			}								
															
		});
		
		// 랜덤생성 모달 창에서 라디오 버튼 변동 시
		$('input:radio').change(function(){
			if($('input:radio[id="add_one"]').is(':checked')){
				$('#add_count').css('display', 'none');
				$("#add_count").val(null);
				
				$("#genresult_several").css('display', 'none');
				$("#genresult_download").css('display', 'none');
			}
			else if($('input:radio[id="add_several"]').is(':checked')){
				$('#add_count').css('display', 'inline');
				$("#add_count").val(null);
				
				$("#genresult_type").css('display', 'none');
				$("#genresult_id").css('display', 'none');
				$("#genresult_type").text('카테고리 : ');
				$("#genresult_id").text('모션아이디 : ');
			}
		});
			
		// 랜덤생성 - 카테고리 드롭박스 클릭 시
		$("#dropdownMenu2").on('click', function(){
			$.ajax({
				url: "php/load_cate.php",
				type: "GET",
				async:false,
				success: function(data){
					result = JSON.parse(data);	
				
					$("#dropdownMenuResult2").children().remove();
										
					for(i=0; i<result.length; i++){
						$('#dropdownMenuResult2:last').append('<li role="presentation"><input class="add_cate" type="submit" value="' + result[i][0] +'"></li>');
					}
						 
					$(".add_cate").on('click', function() {
						add_current_cate = $(this).val();
						document.getElementById("dropdownMenu2").innerHTML = add_current_cate + '<span class="caret"></span>';
					});
				},
				error: function(data){
					alert("error by load_cate.php");
				}
			});
		});
		
		// 랜덤생성 모달 창에서 생성 버튼 클릭 시
		$("#generate_id").on('click', function(){
			if(!$('input:radio').is(':checked')){
				alert("1개 / 여러 개 중 하나를 반드시 선택해야 합니다.");
				if(add_current_cate == null) alert("생성할 카테고리를 선택해야 합니다.");
				resetSearch3();
			}
			else if($('input:radio[id="add_several"]').is(':checked')){
				if(document.getElementById("add_count").value == null){
					alert("개수를 입력해야 합니다.");
					resetSearch3();
				}
				else{ //여러 개 생성 시				
					$("#genresult_several").css('display', 'block');
					$("#genresult_download").css('display', 'block');
					
					var csvString = 'motion_type(category),motion_id(motionID)\r\n';
					for(i=0; i<document.getElementById("add_count").value; i++){
						var temp_id = generateId(add_current_cate);
						
						//엑셀 내에서도 중복 검색
						while(csvString.indexOf("," + temp_id) != -1) temp_id = generateId(add_current_cate);
						
						csvString += add_current_cate + ',' + temp_id + '\r\n';
					}
					tempString = csvString.substring(43,csvString.length);
					
					// download stuff
					var blob = new Blob([csvString], {"type": "text/csv;charset=utf8;"});					
					
					var link = document.getElementById("genresult_download");
					
					if(link.download !== undefined) { // feature detection
						// Browsers that support HTML5 download attribute
						link.setAttribute("href", window.URL.createObjectURL(blob));
						link.setAttribute("download", "generateID_" + add_current_cate + ".csv");
					 }
					else {
						// it needs to implement server side export
						link.setAttribute("href", "http://tnwls0312.dothome.co.kr/export");
					}
					
					alert("생성되었습니다");
				}
			}
			else{ //1개 생성 시
				gen_type_one = add_current_cate;
				gen_id_one = generateId(gen_type_one);
					
				$("#genresult_type").css('display', 'block');
				$("#genresult_id").css('display', 'block');
				$("#genresult_type").text('카테고리 : ' + gen_type_one);
				$("#genresult_id").text('모션아이디 : ' + gen_id_one);

				alert("생성되었습니다");
			}
		});
		
		$("#save_btn").on('click', function(){
			if(gen_type_one && gen_id_one){ //1개 저장 시
				$.ajax({
					url: "php/save_one.php",
					type: "GET",
					async:false,
					data: {	"motion_type" : gen_type_one,
									"motion_id" : gen_id_one},
					success: function(data){
						alert("저장되었습니다.");
						resetSearch3();
						current_cate = gen_type_one;
						cateClicked($("input[value=" + current_cate + "]"));
					},
					error: function(data){
						alert("error by save_one.php");
					}
				});
			}
			else{ //여러 개 저장 시
				check_save_several = 0; 
				tempString = tempString.split('\r\n');
				for(i=0; i<tempString.length;i++) tempString[i] = tempString[i].split(',');
		
				for(i=0; i<tempString.length-1;i++){
					gen_type_several[i] = tempString[i][0];
					gen_id_several[i] = tempString[i][1];
				}
				
				for(i=0; i<gen_type_several.length;i++){
					$.ajax({
						url: "php/save_one.php",
						type: "GET",
						async:false,
						data: {	"motion_type" : gen_type_several[i],  
										"motion_id" : gen_id_several[i]},
						success: function(data){
							check_save_several += 1;
						},
						error: function(data){
							alert("error by save_one.php");
						}
					});
				}
				
				if(check_save_several == gen_type_several.length){
					alert("저장되었습니다.");
					resetSearch3();
					current_cate = gen_type_several[0];
					cateClicked($("input[value=" + current_cate + "]"));
				}
				else{
					alert("저장 실패");
				}
			}
		});
			
	</script>
	
</body>
</html>
